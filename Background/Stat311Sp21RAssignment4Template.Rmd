
ASSSIGNMENT
```{r setup, include=FALSE}
library(knitr)
library(dplyr)
library(ggplot2)
library(BSDA)
source("Functions.R")
knitr::opts_chunk$set(echo = TRUE)
SHOW_SOLUTIONS = TRUE
```
EXPLORATORY DATA ANALYISIS
1.Read the ice cream, birthweight, and cholesterol data sets.

The following fucntions reads the three datasets and displays their structures through the View() function

```{r, eval=TRUE}
IC.df <- read.csv("E:/DATA SCIENCE JOBS/R-Analysis Significance Test/Background/IceCream.csv", header=TRUE, as.is=TRUE)
IC.df$Sex <- as.factor(IC.df$Sex)
IC.df$Flavor <- as.factor(IC.df$Flavor)
View(IC.df)
#
BW.df <- read.csv("E:/DATA SCIENCE JOBS/R-Analysis Significance Test/Background/BirthWeight.csv", header=TRUE, as.is=TRUE)
BW.df$Smoker <- as.factor(BW.df$Smoker)
BW.df$BirthWt <- as.factor(BW.df$BirthWt)
BW.df$MAgeGT35 <- as.factor(BW.df$MAgeGT35)
View(BW.df)
#
C.df <- read.csv("E:/DATA SCIENCE JOBS/R-Analysis Significance Test/Background/Cholesterol.csv", header=TRUE, as.is=TRUE)
View(C.df)
C.df$Cereal <- as.factor(C.df$Cereal)
```
1. Find and interpret the 92% confidence interval for the population mean puzzle score.


```{r t test for a single mean}
# Look at the t.test help file
?t.test

# First interval is 95%, which is the default if you do
# not specify conf.level
t.test(IC.df$Puzzle)$conf.int

```



2. Hypothesis test for the difference between mean puzzle scores by ice cream type. a. Create two subsets of puzzle scores, one for students that favor strawberry ice cream and one for students that favor chocolate ice cream. b. Test the claim that students with a preference for strawberry ice cream have higher puzzle scores than students that prefer chocolate ice cream. Use strawberry minus chocolate and a 1% significance level. Assume the population variances are not equal. c. Do you think the statistical test results from part (b) have practical significance? 
```{r t test for two means, independent samples}
# First get the right subset of data
D.CD <- filter(IC.df, Flavor == "1")
D.CI <- filter(IC.df, Flavor == "2")

# Look at the samples sizes and samples SDs for each group 
# to inform the decision for un-pooled or pooled variance.
n.CD <- nrow(D.CD)
sd.CD <- sd(D.CD$Puzzle)
n.CI <- nrow(D.CI)
sd.CI <- sd(D.CI$Puzzle)
cbind(nCD = n.CD, SD.CD = sd.CD, nCI = n.CI, SD.CI = sd.CI)

# The sample size for color D is smallish; the two sample
# SDs are similar. This could go either way. If we pool, 
# we will be giving a higher weight to the lower variance.
# Checking our ROT gives us a ratio < 3 (code shown below), 
# so pooling is probably okay.

sd.CD^2/sd.CI^2

# Using un-pooled would be most conservative. At the same time
# pooling may be reasonable because we might expect the
# population variances to be similar for Weight (would we expect
# the variation in Weight to be different for different colors?).

# We will run it both ways here so you can see the difference--in
# practice, you would make a choice based on your understanding
# of diamond weights and go from there.

# First interval is 1% using an un-pooled variance, both are
# defaults 
t.test(D.CD$Puzzle, D.CI$Puzzle,conf.level=0.01)$conf.int


# Same interval as above but with pooled variance
t.test(D.CD$Puzzle, D.CI$Puzzle, var.equal=TRUE)$conf.int
```
```{r Looking a df for un-pooled vs. pooled}
# Same two calls from above after removing the $conf.int at 
# the end to see all the t.test output
t.test(D.CD$Puzzle, D.CI$Puzzle,conf.level=0.01)$conf.int
t.test(D.CD$Puzzle, D.CI$Puzzle, var.equal=TRUE)

```


3. Using the oneprop.CI function in the R4 Tutorial, find the 98% confidence interval for the proportion of smokers in the birthweight data set. Assume large sample conditions are met.



4. Consider birthweights for mothers that are smokers and nonsmokers.   a. Create a function called twoprop.HT that uses a two-sample z test to test for the difference between two population proportions assuming independent samples. b. Test the claim that the proportion of low birthweight babies is higher for mothers that smoked (use smoked – did not smoke). Use a 5% significance level. Assume large sample conditions are met. c. Are the large sample conditions met for the test in (b)? Note, you can just look at the table values instead of doing any calculations. Do you think the hypothesis test results in
(b) are valid? 
 ```
 
 
 ```
5. This problem was modified from here. A cross-over trial experiment was used to investigate whether eating oat bran lowered serum cholesterol levels. Twelve individuals were randomly assigned a diet that included either oat bran or corn flakes. After two weeks on the initial diet, serum cholesterol (mmol/L) was measured and then participants were “crossed-over” to the other diet. After two-weeks on the second diet, cholesterol levels were once again recorded.  a. Using a 5% significance level, test the claim that a diet that includes oat bran decreases serum cholesterol. [Use Cornflk – OatBran] b. Construct an appropriate confidence interval that could be used as an equivalent to the test in part (a). [Use Cornflake – OatBran]. Explain your choice and interpret the interval. 
```




```

 6. In clinical experiments involving different groups of independent samples, it is important that the groups be similar in the important ways that affect the experiment. In an experiment designed to test the effectiveness of paroxetine for treating bipolar depression, subjects were measured using the Hamilton depression scale with the results given below (based on data from a “Double-Blind, Placebo-Controlled Comparison of Imipramine and Paroxetine in the Treatment of Bipolar Depression,” by Nemeroff et al., American Journal of Psychiatry, Vol. 158, No. 6). Use a 0.05 significance level to test the claim that the treatment and placebo groups come from populations with the same mean. Assume equal population variances. [Use Treatment – Placebo]  

```


```